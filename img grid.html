<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=600, initial-scale=1.0">
  <title>Double Image Slide Demo</title>
  <style>
    #image-grid {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }
    .p1{
        margin-top: 100vh;
    }
    .parent {
      position: relative;
      width: 600px;
      height: 300px;
      overflow: hidden;
      /* margin-top: 100vh; */
       /* For demo scroll */
      background: #e0e0e0;
      margin-bottom: 30px;
    }

    /* Shared styles */
    .img {
      position: absolute;
      top: 0;
      bottom: 0;
      background-size: cover;
      background-position: center;
      transition: transform 1s cubic-bezier(0.77,0,0.175,1);
    }

    /* FIRST PARENT: the original animation */
    .p1 .img1 { left: 0; width: 50%; background-image: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb'); z-index: 1; }
    .p1 .img2 { left: 50%; width: 50%; background-image: url('https://images.unsplash.com/photo-1465101046530-73398c7f28ca'); z-index: 1; }
    .p1 .img3 { right: 0; width: 50%; height: 100%; background-image: url('https://imgs.search.brave.com/oO_-tTqxmTp-608UIFCcRDqk_5sNQE-w2beIN4fLff0/rs:fit:500:0:1:0/g:ce/aHR0cHM6Ly9zdGF0/aWMudmVjdGVlenku/Y29tL3N5c3RlbS9y/ZXNvdXJjZXMvdGh1/bWJuYWlscy8wNTAv/MzkxLzI3NC9zbWFs/bC9zdW5yaXNlLW9y/LXN1bnNldC1ibHVl/LWFuZC1wZWFjaC1z/a3ktbW9ybmluZy1j/b2xvcmZ1bC1sb25n/LXNob3QtZXZlbmlu/Zy1zZXJlbmUtc3Vu/c2V0LWNhbG0tbGFu/ZHNjYXBlLW5hdHVy/ZS1zdW5yaXNlLXBl/YWNlZnVsLXZpYnJh/bnQtYmx1ZS1za3kt/YnJlYXRodGFraW5n/LWJlYXV0aWZ1bC10/cmFucXVpbC1waG90/by5qcGc'); z-index: 2; pointer-events: none;}

    .p1.animate .img1 { transform: translateX(-100%); }
    .p1.animate .img2 { transform: translateX(-100%); }

    /* SECOND PARENT: image 1 on top, img2 behind img1, img3 on the right */
    .p2 .img1 {
      left: 0; width: 50%;
      background-image: url('https://images.unsplash.com/photo-1465101046530-73398c7f28ca');
      /* image 1 on top */
      z-index: 3;
    }
    .p2 .img2 {
      left: 0; width: 50%;
      background-image: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb');
      /* behind image 1 and img3 */
      z-index: 1;
    }
    .p2 .img3 {
      right: 0; width: 50%; height: 100%;
      background-image: url('https://imgs.search.brave.com/oO_-tTqxmTp-608UIFCcRDqk_5sNQE-w2beIN4fLff0/rs:fit:500:0:1:0/g:ce/aHR0cHM6Ly9zdGF0/aWMudmVjdGVlenku/Y29tL3N5c3RlbS9y/ZXNvdXJjZXMvdGh1/bWJuYWlscy8wNTAv/MzkxLzI3NC9zbWFs/bC9zdW5yaXNlLW9y/LXN1bnNldC1ibHVl/LWFuZC1wZWFjaC1z/a3ktbW9ybmluZy1j/b2xvcmZ1bC1sb25n/LXNob3QtZXZlbmlu/Zy1zZXJlbmUtc3Vu/c2V0LWNhbG0tbGFu/ZHNjYXBlLW5hdHVy/ZS1zdW5yaXNlLXBl/YWNlZnVsLXZpYnJh/bnQtYmx1ZS1za3kt/YnJlYXRodGFraW5n/LWJlYXV0aWZ1bC10/cmFucXVpbC1waG90/by5qcGc');
      z-index: 2;
      pointer-events: none;
    }

    /* Animate both img2 and img3 to the right together */
    .p2.animate .img2 {
      transform: translateX(100%);
    }
    .p2.animate .img3 {
      transform: translateX(100%);
    }
  </style>
</head>
<body>
  <div id="image-grid">
    <!-- First parent, your original animation -->
    <div class="parent p1" id="img-animation-parent-1">
      <div class="img img1"></div>
      <div class="img img2"></div>
      <div class="img img3"></div>
    </div>
    <!-- Second parent, as per your new requirements -->
    <div class="parent p2" id="img-animation-parent-2">
      <div class="img img1"></div> <!-- This is on TOP -->
      <div class="img img2"></div> <!-- This moves right underneath -->
      <div class="img img3"></div> <!-- This moves right together with img2 -->
    </div>
  </div>

  <script>
    // Animation observer for both parents
    function setupObserver(parentId, className, reverseMs = 3000) {
      const parent = document.getElementById(parentId);
      let animated = false;
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting && !animated) {
            animated = true;
            parent.classList.add('animate');
            setTimeout(() => {
              parent.classList.remove('animate');
              animated = false;
            }, reverseMs);
          }
        });
      }, { threshold: 1.0 });
      observer.observe(parent);
    }

    setupObserver('img-animation-parent-1', 'p1');
    setupObserver('img-animation-parent-2', 'p2');
  </script>
</body>
</html>